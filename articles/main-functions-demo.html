<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>main-functions-demo â€¢ trisk.analysis</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="main-functions-demo">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">trisk.analysis</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/main-functions-demo.html">main-functions-demo</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>main-functions-demo</h1>
            
      

      <div class="d-none name"><code>main-functions-demo.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">trisk.analysis</span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">trisk.model</span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="trisk-analysis-main-functions-demo">trisk.analysis main functions demo<a class="anchor" aria-label="anchor" href="#trisk-analysis-main-functions-demo"></a>
</h2>
<p>This vignette demonstrates how to use the <code>trisk.model</code>
package to download input data, run TRISK models, and perform
sensitivity analysis. It walks through the process of running the model,
inspecting outputs, and using filters for more detailed analyses.</p>
<div class="section level4">
<h4 id="download-trisk-input-data">Download TRISK Input Data<a class="anchor" aria-label="anchor" href="#download-trisk-input-data"></a>
</h4>
<p>The TRISK model requires specific input datasets. In this section, we
download these datasets from the defined endpoint and store them in a
local directory.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define the endpoint URL and S3 path for downloading data</span></span>
<span><span class="va">endpoint_url</span> <span class="op">&lt;-</span> <span class="st">"https://crispy-datamodels-bucket.fra1.cdn.digitaloceanspaces.com"</span></span>
<span><span class="va">s3_path</span> <span class="op">&lt;-</span> <span class="st">"crispy-datamodels-bucket/trisk_V2/csv"</span></span>
<span><span class="va">local_trisk_inputs_folder</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">".."</span>,<span class="st">"data-raw"</span>, <span class="st">"data"</span>, <span class="st">"trisk_inputs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Download TRISK input data</span></span>
<span><span class="fu"><a href="../reference/download_trisk_inputs.html">download_trisk_inputs</a></span><span class="op">(</span><span class="va">endpoint_url</span>, <span class="va">s3_path</span>, <span class="va">local_trisk_inputs_folder</span><span class="op">)</span></span>
<span><span class="co">#&gt; Download completed.</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="run-a-simple-trisk-model">Run a Simple TRISK Model<a class="anchor" aria-label="anchor" href="#run-a-simple-trisk-model"></a>
</h4>
<p>Next, we demonstrate a simple TRISK model run using a baseline and
target scenario. We also measure the time taken for the execution.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Set output path for TRISK results</span></span>
<span><span class="va">trisk_output_path</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/file.path.html" class="external-link">file.path</a></span><span class="op">(</span><span class="st">".."</span>,<span class="st">"data-raw"</span>, <span class="st">"data"</span>, <span class="st">"trisk_outputs"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Measure execution time</span></span>
<span><span class="va">start_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run TRISK model with baseline and target scenarios</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/trisk.model/man/run_trisk.html" class="external-link">run_trisk</a></span><span class="op">(</span></span>
<span>  input_path <span class="op">=</span> <span class="va">local_trisk_inputs_folder</span>,</span>
<span>  output_path <span class="op">=</span> <span class="va">trisk_output_path</span>,</span>
<span>  baseline_scenario <span class="op">=</span> <span class="st">"Steel_baseline"</span>,</span>
<span>  target_scenario <span class="op">=</span> <span class="st">"Steel_NZ"</span>,</span>
<span>  scenario_geography <span class="op">=</span> <span class="st">"Global"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; -- Processing Assets and Scenarios. </span></span>
<span><span class="co">#&gt; -- Transforming to Trisk model input. </span></span>
<span><span class="co">#&gt; -- Calculating baseline, target, and shock trajectories. </span></span>
<span><span class="co">#&gt; -- Calculating net profits. </span></span>
<span><span class="co">#&gt; -- Calculating market risk. </span></span>
<span><span class="co">#&gt; -- Calculating credit risk. </span></span>
<span><span class="co">#&gt; Removed 950 rows when checking for compatibility with merton model. </span></span>
<span><span class="co">#&gt; [1] "Outputs saved in folder: ../data-raw/data/trisk_outputs/20240925_195845__72828734-7719-47cb-b465-37b78b6df0d5"</span></span>
<span></span>
<span><span class="co"># End time</span></span>
<span><span class="va">end_time</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.time.html" class="external-link">Sys.time</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Calculate time taken for execution</span></span>
<span><span class="va">time_taken</span> <span class="op">&lt;-</span> <span class="va">end_time</span> <span class="op">-</span> <span class="va">start_time</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">time_taken</span><span class="op">)</span></span>
<span><span class="co">#&gt; Time difference of 2.88232 secs</span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="view-latest-trisk-results">View Latest TRISK Results<a class="anchor" aria-label="anchor" href="#view-latest-trisk-results"></a>
</h4>
<p>After the model has been run, we can inspect the results. TRISK
results can include various metrics such as NPV, PD, trajectories, and
parameters.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Print the latest TRISK results for different result types</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_latest_trisk_result.html">get_latest_trisk_result</a></span><span class="op">(</span>trisk_output_path <span class="op">=</span> <span class="va">trisk_output_path</span>, result_type <span class="op">=</span> <span class="st">"npv"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">777</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">19</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â”€â”€</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (11): run_id, company_id, asset_id, company_name, asset_name, sector, te...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span>  (8): net_present_value_baseline, net_present_value_shock, risk_free_rat...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 777 Ã— 19</span></span></span>
<span><span class="co">#&gt;    run_id          company_id asset_id company_name asset_name sector technology</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 72828734-7719-â€¦ E10000000â€¦ P100000â€¦ Kobe Steel â€¦ Kobe Kakoâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 72828734-7719-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Eaâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 72828734-7719-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ North Nipâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 72828734-7719-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Eaâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 72828734-7719-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Kyâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 72828734-7719-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Kyâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 72828734-7719-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Eaâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 72828734-7719-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Kaâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 72828734-7719-â€¦ E10000000â€¦ P100000â€¦ ArcelorMittâ€¦ ArcelorMiâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 72828734-7719-â€¦ E10000000â€¦ P100000â€¦ ArcelorMittâ€¦ ArcelorMiâ€¦ Steel  EAF-MM    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 767 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 12 more variables: net_present_value_baseline &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   net_present_value_shock &lt;dbl&gt;, baseline_scenario &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   target_scenario &lt;chr&gt;, scenario_geography &lt;chr&gt;, carbon_price_model &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   risk_free_rate &lt;dbl&gt;, discount_rate &lt;dbl&gt;, growth_rate &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   div_netprofit_prop_coef &lt;dbl&gt;, shock_year &lt;dbl&gt;, market_passthrough &lt;dbl&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_latest_trisk_result.html">get_latest_trisk_result</a></span><span class="op">(</span>trisk_output_path <span class="op">=</span> <span class="va">trisk_output_path</span>, result_type <span class="op">=</span> <span class="st">"pd"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">2915</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">17</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â”€â”€</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (8): run_id, company_id, company_name, sector, baseline_scenario, target...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (9): term, pd_baseline, pd_shock, risk_free_rate, discount_rate, growth_...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2,915 Ã— 17</span></span></span>
<span><span class="co">#&gt;    run_id              company_id company_name sector  term pd_baseline pd_shock</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 72828734-7719-47cbâ€¦ E10000000â€¦ Kobe Steel â€¦ Steel      1    4.53<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span>  0.004<span style="text-decoration: underline;">56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 72828734-7719-47cbâ€¦ E10000000â€¦ Kobe Steel â€¦ Steel      2    1.03<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>  0.038<span style="text-decoration: underline;">5</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 72828734-7719-47cbâ€¦ E10000000â€¦ Kobe Steel â€¦ Steel      3    6.81<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>  0.083<span style="text-decoration: underline;">4</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 72828734-7719-47cbâ€¦ E10000000â€¦ Kobe Steel â€¦ Steel      4    5.75<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.126  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 72828734-7719-47cbâ€¦ E10000000â€¦ Kobe Steel â€¦ Steel      5    2.12<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>  0.165  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 72828734-7719-47cbâ€¦ E10000000â€¦ Nippon Steeâ€¦ Steel      1    1.41<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span>  0.011<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 72828734-7719-47cbâ€¦ E10000000â€¦ Nippon Steeâ€¦ Steel      2    1.87<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>  0.063<span style="text-decoration: underline;">8</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 72828734-7719-47cbâ€¦ E10000000â€¦ Nippon Steeâ€¦ Steel      3    1.03<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.119  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 72828734-7719-47cbâ€¦ E10000000â€¦ Nippon Steeâ€¦ Steel      4    7.97<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.168  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 72828734-7719-47cbâ€¦ E10000000â€¦ Nippon Steeâ€¦ Steel      5    2.78<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>  0.209  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 2,905 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 10 more variables: baseline_scenario &lt;chr&gt;, target_scenario &lt;chr&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   scenario_geography &lt;chr&gt;, carbon_price_model &lt;chr&gt;, risk_free_rate &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   discount_rate &lt;dbl&gt;, growth_rate &lt;dbl&gt;, div_netprofit_prop_coef &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   shock_year &lt;dbl&gt;, market_passthrough &lt;dbl&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_latest_trisk_result.html">get_latest_trisk_result</a></span><span class="op">(</span>trisk_output_path <span class="op">=</span> <span class="va">trisk_output_path</span>, result_type <span class="op">=</span> <span class="st">"trajectories"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">30848</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">32</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â”€â”€</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (11): run_id, asset_id, asset_name, company_id, company_name, sector, te...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (21): year, production_plan_company_technology, production_baseline_scen...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 30,848 Ã— 32</span></span></span>
<span><span class="co">#&gt;    run_id    asset_id asset_name company_id company_name  year sector technology</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 72828734â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>020 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 72828734â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>021 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 72828734â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>022 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 72828734â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>023 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 72828734â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>024 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 72828734â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>025 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 72828734â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>026 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 72828734â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>027 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 72828734â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>028 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 72828734â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>029 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 30,838 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 24 more variables: production_plan_company_technology &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   production_baseline_scenario &lt;dbl&gt;, production_target_scenario &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   production_shock_scenario &lt;dbl&gt;, pd &lt;dbl&gt;, net_profit_margin &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   debt_equity_ratio &lt;dbl&gt;, volatility &lt;dbl&gt;, scenario_price_baseline &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   price_shock_scenario &lt;dbl&gt;, net_profits_baseline_scenario &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   net_profits_shock_scenario &lt;dbl&gt;, â€¦</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="fu"><a href="../reference/get_latest_trisk_result.html">get_latest_trisk_result</a></span><span class="op">(</span>trisk_output_path <span class="op">=</span> <span class="va">trisk_output_path</span>, result_type <span class="op">=</span> <span class="st">"params"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Rows: </span><span style="color: #0000BB;">1</span> <span style="font-weight: bold;">Columns: </span><span style="color: #0000BB;">11</span></span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â”€â”€</span> <span style="font-weight: bold;">Column specification</span> <span style="color: #00BBBB;">â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€</span></span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Delimiter:</span> ","</span></span>
<span><span class="co">#&gt; <span style="color: #BB0000;">chr</span> (5): baseline_scenario, target_scenario, scenario_geography, carbon_pric...</span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">dbl</span> (6): risk_free_rate, discount_rate, growth_rate, div_netprofit_prop_coef...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Use `spec()` to retrieve the full column specification for this data.</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">â„¹</span> Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 11</span></span></span>
<span><span class="co">#&gt;   baseline_scenario target_scenario scenario_geography carbon_price_model</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Steel_baseline    Steel_NZ        Global             no_carbon_tax     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 7 more variables: risk_free_rate &lt;dbl&gt;, discount_rate &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   growth_rate &lt;dbl&gt;, div_netprofit_prop_coef &lt;dbl&gt;, shock_year &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   market_passthrough &lt;dbl&gt;, run_id &lt;chr&gt;</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="run-a-filtered-trisk-model-optional">Run a Filtered TRISK Model (Optional)<a class="anchor" aria-label="anchor" href="#run-a-filtered-trisk-model-optional"></a>
</h4>
<p>You can also run the TRISK model on a filtered subset of assets. This
example filters the dataset by country, sector, and technology.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run the TRISK model with a smaller filtered dataset (currently unused)</span></span>
<span><span class="va">single_filtered_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_trisk_single_filtered.html">run_trisk_single_filtered</a></span><span class="op">(</span></span>
<span>  input_path <span class="op">=</span> <span class="va">local_trisk_inputs_folder</span>,</span>
<span>  run_params <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    scenario_geography <span class="op">=</span> <span class="st">"Global"</span>,</span>
<span>    baseline_scenario <span class="op">=</span> <span class="st">"Steel_baseline"</span>,</span>
<span>    target_scenario <span class="op">=</span> <span class="st">"Steel_NZ"</span>,</span>
<span>    shock_year <span class="op">=</span> <span class="fl">2030</span></span>
<span>  <span class="op">)</span>,</span>
<span>  country_iso2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"US"</span>, <span class="st">"AR"</span><span class="op">)</span>,</span>
<span>  sector <span class="op">=</span> <span class="st">"Steel"</span>,</span>
<span>  technology <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EAF-DRI"</span>, <span class="st">"BOF-BF"</span><span class="op">)</span>,</span>
<span>  company_name <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; -- Processing Assets and Scenarios. </span></span>
<span><span class="co">#&gt; -- Transforming to Trisk model input. </span></span>
<span><span class="co">#&gt; -- Calculating baseline, target, and shock trajectories. </span></span>
<span><span class="co">#&gt; -- Calculating net profits. </span></span>
<span><span class="co">#&gt; -- Calculating market risk. </span></span>
<span><span class="co">#&gt; -- Calculating credit risk. </span></span>
<span><span class="co">#&gt; Removed 30 rows when checking for compatibility with merton model.</span></span>
<span></span>
<span><span class="co"># Print the filtered TRISK results for different result types</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">single_filtered_results</span><span class="op">[</span><span class="st">"npv"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $npv</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 15 Ã— 9</span></span></span>
<span><span class="co">#&gt;    run_id          company_id asset_id company_name asset_name sector technology</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> c4c34dfd-d591-â€¦ E10000000â€¦ P100000â€¦ ArcelorMittâ€¦ ArcelorMiâ€¦ Steel  EAF-DRI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> c4c34dfd-d591-â€¦ E10000000â€¦ P100000â€¦ United Statâ€¦ U.S. Steeâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> c4c34dfd-d591-â€¦ E10000000â€¦ P100000â€¦ United Statâ€¦ U.S. Steeâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> c4c34dfd-d591-â€¦ E10000000â€¦ P100000â€¦ Siderca SAIâ€¦ TenarisSiâ€¦ Steel  EAF-DRI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> c4c34dfd-d591-â€¦ E10000013â€¦ P100000â€¦ Ternium Argâ€¦ Ternium Sâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> c4c34dfd-d591-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> c4c34dfd-d591-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> c4c34dfd-d591-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> c4c34dfd-d591-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> c4c34dfd-d591-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> c4c34dfd-d591-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> c4c34dfd-d591-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  EAF-DRI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> c4c34dfd-d591-â€¦ E10000101â€¦ P100000â€¦ Acindar Indâ€¦ ArcelorMiâ€¦ Steel  EAF-DRI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> c4c34dfd-d591-â€¦ E10000101â€¦ P100000â€¦ Nucor Steelâ€¦ Nucor Steâ€¦ Steel  EAF-DRI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> c4c34dfd-d591-â€¦ E10000101â€¦ P100000â€¦ Steel Dynamâ€¦ Steel Dynâ€¦ Steel  EAF-DRI   </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 2 more variables: net_present_value_baseline &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   net_present_value_shock &lt;dbl&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">single_filtered_results</span><span class="op">[</span><span class="st">"pd"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $pd</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 25 Ã— 7</span></span></span>
<span><span class="co">#&gt;    run_id              company_id company_name sector  term pd_baseline pd_shock</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> c4c34dfd-d591-4a89â€¦ E10000000â€¦ United Statâ€¦ Steel      1    1.41<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span>  0.110  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> c4c34dfd-d591-4a89â€¦ E10000000â€¦ United Statâ€¦ Steel      2    1.87<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>  0.216  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> c4c34dfd-d591-4a89â€¦ E10000000â€¦ United Statâ€¦ Steel      3    1.03<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.282  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> c4c34dfd-d591-4a89â€¦ E10000000â€¦ United Statâ€¦ Steel      4    7.97<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.329  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> c4c34dfd-d591-4a89â€¦ E10000000â€¦ United Statâ€¦ Steel      5    2.78<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>  0.365  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> c4c34dfd-d591-4a89â€¦ E10000000â€¦ Siderca SAIâ€¦ Steel      1    3.57<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span>  0.001<span style="text-decoration: underline;">73</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> c4c34dfd-d591-4a89â€¦ E10000000â€¦ Siderca SAIâ€¦ Steel      2    9.12<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span>  0.023<span style="text-decoration: underline;">1</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> c4c34dfd-d591-4a89â€¦ E10000000â€¦ Siderca SAIâ€¦ Steel      3    6.27<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>  0.058<span style="text-decoration: underline;">7</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> c4c34dfd-d591-4a89â€¦ E10000000â€¦ Siderca SAIâ€¦ Steel      4    5.41<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.096<span style="text-decoration: underline;">2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> c4c34dfd-d591-4a89â€¦ E10000000â€¦ Siderca SAIâ€¦ Steel      5    2.01<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>  0.132  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 15 more rows</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">single_filtered_results</span><span class="op">[</span><span class="st">"trajectories"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $trajectories</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 800 Ã— 22</span></span></span>
<span><span class="co">#&gt;    run_id    asset_id asset_name company_id company_name  year sector technology</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> c4c34dfdâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>020 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> c4c34dfdâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>021 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> c4c34dfdâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>022 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> c4c34dfdâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>023 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> c4c34dfdâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>024 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> c4c34dfdâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>025 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> c4c34dfdâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>026 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> c4c34dfdâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>027 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> c4c34dfdâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>028 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> c4c34dfdâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>029 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 790 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 14 more variables: production_plan_company_technology &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   production_baseline_scenario &lt;dbl&gt;, production_target_scenario &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   production_shock_scenario &lt;dbl&gt;, pd &lt;dbl&gt;, net_profit_margin &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   debt_equity_ratio &lt;dbl&gt;, volatility &lt;dbl&gt;, scenario_price_baseline &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   price_shock_scenario &lt;dbl&gt;, net_profits_baseline_scenario &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   net_profits_shock_scenario &lt;dbl&gt;, â€¦</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">single_filtered_results</span><span class="op">[</span><span class="st">"params"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $params</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 Ã— 11</span></span></span>
<span><span class="co">#&gt;   baseline_scenario target_scenario scenario_geography carbon_price_model</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> <span style="color: #949494;">""</span>                <span style="color: #949494;">""</span>              Global             no_carbon_tax     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 7 more variables: risk_free_rate &lt;dbl&gt;, discount_rate &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   growth_rate &lt;dbl&gt;, div_netprofit_prop_coef &lt;dbl&gt;, shock_year &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   market_passthrough &lt;dbl&gt;, run_id &lt;chr&gt;</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sensitivity-analysis">Sensitivity Analysis<a class="anchor" aria-label="anchor" href="#sensitivity-analysis"></a>
</h4>
<p>Sensitivity analysis allows us to explore how changes in parameters
affect the results. In this example, we vary the shock year in multiple
TRISK runs.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Define run parameters for sensitivity analysis</span></span>
<span><span class="va">run_params</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    scenario_geography <span class="op">=</span> <span class="st">"Global"</span>,</span>
<span>    baseline_scenario <span class="op">=</span> <span class="st">"Steel_baseline"</span>,</span>
<span>    target_scenario <span class="op">=</span> <span class="st">"Steel_NZ"</span>,</span>
<span>    shock_year <span class="op">=</span> <span class="fl">2030</span></span>
<span>  <span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>    scenario_geography <span class="op">=</span> <span class="st">"Global"</span>,</span>
<span>    baseline_scenario <span class="op">=</span> <span class="st">"Steel_baseline"</span>,</span>
<span>    target_scenario <span class="op">=</span> <span class="st">"Steel_NZ"</span>,</span>
<span>    shock_year <span class="op">=</span> <span class="fl">2025</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Run sensitivity analysis across multiple TRISK runs</span></span>
<span><span class="va">sensitivity_analysis_results</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_trisk_sa.html">run_trisk_sa</a></span><span class="op">(</span></span>
<span>  input_path <span class="op">=</span> <span class="va">local_trisk_inputs_folder</span>,</span>
<span>  run_params <span class="op">=</span> <span class="va">run_params</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Starting the execution of 2 total runs"</span></span>
<span><span class="co">#&gt; -- Processing Assets and Scenarios. </span></span>
<span><span class="co">#&gt; -- Transforming to Trisk model input. </span></span>
<span><span class="co">#&gt; -- Calculating baseline, target, and shock trajectories. </span></span>
<span><span class="co">#&gt; -- Calculating net profits. </span></span>
<span><span class="co">#&gt; -- Calculating market risk. </span></span>
<span><span class="co">#&gt; -- Calculating credit risk. </span></span>
<span><span class="co">#&gt; Removed 950 rows when checking for compatibility with merton model. </span></span>
<span><span class="co">#&gt; [1] "Done 1 / 2 total runs"</span></span>
<span><span class="co">#&gt; -- Processing Assets and Scenarios. </span></span>
<span><span class="co">#&gt; -- Transforming to Trisk model input. </span></span>
<span><span class="co">#&gt; -- Calculating baseline, target, and shock trajectories. </span></span>
<span><span class="co">#&gt; -- Calculating net profits. </span></span>
<span><span class="co">#&gt; -- Calculating market risk. </span></span>
<span><span class="co">#&gt; -- Calculating credit risk. </span></span>
<span><span class="co">#&gt; Removed 590 rows when checking for compatibility with merton model. </span></span>
<span><span class="co">#&gt; [1] "Done 2 / 2 total runs"</span></span>
<span><span class="co">#&gt; [1] "All runs completed."</span></span>
<span></span>
<span><span class="co"># Print sensitivity analysis results for different result types</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sensitivity_analysis_results</span><span class="op">[</span><span class="st">"npv"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $npv</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,555 Ã— 9</span></span></span>
<span><span class="co">#&gt;    run_id          company_id asset_id company_name asset_name sector technology</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 30bb55a0-559e-â€¦ E10000000â€¦ P100000â€¦ Kobe Steel â€¦ Kobe Kakoâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 30bb55a0-559e-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Eaâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 30bb55a0-559e-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ North Nipâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 30bb55a0-559e-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Eaâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 30bb55a0-559e-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Kyâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 30bb55a0-559e-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Kyâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 30bb55a0-559e-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Eaâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 30bb55a0-559e-â€¦ E10000000â€¦ P100000â€¦ Nippon Steeâ€¦ Nippon Kaâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 30bb55a0-559e-â€¦ E10000000â€¦ P100000â€¦ ArcelorMittâ€¦ ArcelorMiâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 30bb55a0-559e-â€¦ E10000000â€¦ P100000â€¦ ArcelorMittâ€¦ ArcelorMiâ€¦ Steel  EAF-MM    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 1,545 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 2 more variables: net_present_value_baseline &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   net_present_value_shock &lt;dbl&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sensitivity_analysis_results</span><span class="op">[</span><span class="st">"pd"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $pd</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 6,190 Ã— 7</span></span></span>
<span><span class="co">#&gt;    run_id              company_id company_name sector  term pd_baseline pd_shock</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 30bb55a0-559e-4b44â€¦ E10000000â€¦ Kobe Steel â€¦ Steel      1    4.53<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span>  0.004<span style="text-decoration: underline;">56</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 30bb55a0-559e-4b44â€¦ E10000000â€¦ Kobe Steel â€¦ Steel      2    1.03<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>  0.038<span style="text-decoration: underline;">5</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 30bb55a0-559e-4b44â€¦ E10000000â€¦ Kobe Steel â€¦ Steel      3    6.81<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>  0.083<span style="text-decoration: underline;">4</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 30bb55a0-559e-4b44â€¦ E10000000â€¦ Kobe Steel â€¦ Steel      4    5.75<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.126  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 30bb55a0-559e-4b44â€¦ E10000000â€¦ Kobe Steel â€¦ Steel      5    2.12<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>  0.165  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 30bb55a0-559e-4b44â€¦ E10000000â€¦ Nippon Steeâ€¦ Steel      1    1.41<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span>  0.011<span style="text-decoration: underline;">6</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 30bb55a0-559e-4b44â€¦ E10000000â€¦ Nippon Steeâ€¦ Steel      2    1.87<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>  0.063<span style="text-decoration: underline;">8</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 30bb55a0-559e-4b44â€¦ E10000000â€¦ Nippon Steeâ€¦ Steel      3    1.03<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.119  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 30bb55a0-559e-4b44â€¦ E10000000â€¦ Nippon Steeâ€¦ Steel      4    7.97<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.168  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 30bb55a0-559e-4b44â€¦ E10000000â€¦ Nippon Steeâ€¦ Steel      5    2.78<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>  0.209  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 6,180 more rows</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sensitivity_analysis_results</span><span class="op">[</span><span class="st">"trajectories"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $trajectories</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 61,696 Ã— 22</span></span></span>
<span><span class="co">#&gt;    run_id    asset_id asset_name company_id company_name  year sector technology</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 30bb55a0â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>020 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 30bb55a0â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>021 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 30bb55a0â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>022 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 30bb55a0â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>023 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 30bb55a0â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>024 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 30bb55a0â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>025 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 30bb55a0â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>026 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 30bb55a0â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>027 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 30bb55a0â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>028 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 30bb55a0â€¦ GASTAGOâ€¦ <span style="color: #BB0000;">NA</span>         100748a83â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>029 Steel  EAF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 61,686 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 14 more variables: production_plan_company_technology &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   production_baseline_scenario &lt;dbl&gt;, production_target_scenario &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   production_shock_scenario &lt;dbl&gt;, pd &lt;dbl&gt;, net_profit_margin &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   debt_equity_ratio &lt;dbl&gt;, volatility &lt;dbl&gt;, scenario_price_baseline &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   price_shock_scenario &lt;dbl&gt;, net_profits_baseline_scenario &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   net_profits_shock_scenario &lt;dbl&gt;, â€¦</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sensitivity_analysis_results</span><span class="op">[</span><span class="st">"params"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $params</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 Ã— 11</span></span></span>
<span><span class="co">#&gt;   baseline_scenario target_scenario scenario_geography carbon_price_model</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Steel_baseline    Steel_NZ        Global             no_carbon_tax     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Steel_baseline    Steel_NZ        Global             no_carbon_tax     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 7 more variables: risk_free_rate &lt;dbl&gt;, discount_rate &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   growth_rate &lt;dbl&gt;, div_netprofit_prop_coef &lt;dbl&gt;, shock_year &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   market_passthrough &lt;dbl&gt;, run_id &lt;chr&gt;</span></span></span></code></pre></div>
</div>
<div class="section level4">
<h4 id="sensitivity-analysis-on-filtered-subset">Sensitivity Analysis on Filtered Subset<a class="anchor" aria-label="anchor" href="#sensitivity-analysis-on-filtered-subset"></a>
</h4>
<p>You can also perform sensitivity analysis on a filtered subset of
assets. This example filters the dataset by country, sector, and
technology, and then runs the analysis.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Run sensitivity analysis on a subset of assets</span></span>
<span><span class="va">sensitivity_analysis_results_on_filtered_assets</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/run_trisk_sa.html">run_trisk_sa</a></span><span class="op">(</span></span>
<span>  input_path <span class="op">=</span> <span class="va">local_trisk_inputs_folder</span>,</span>
<span>  run_params <span class="op">=</span> <span class="va">run_params</span>,</span>
<span>  country_iso2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"US"</span>, <span class="st">"AR"</span><span class="op">)</span>,</span>
<span>  sector <span class="op">=</span> <span class="st">"Steel"</span>,</span>
<span>  technology <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EAF-DRI"</span>, <span class="st">"BOF-BF"</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Starting the execution of 2 total runs"</span></span>
<span><span class="co">#&gt; -- Processing Assets and Scenarios. </span></span>
<span><span class="co">#&gt; -- Transforming to Trisk model input. </span></span>
<span><span class="co">#&gt; -- Calculating baseline, target, and shock trajectories. </span></span>
<span><span class="co">#&gt; -- Calculating net profits. </span></span>
<span><span class="co">#&gt; -- Calculating market risk. </span></span>
<span><span class="co">#&gt; -- Calculating credit risk. </span></span>
<span><span class="co">#&gt; Removed 30 rows when checking for compatibility with merton model. </span></span>
<span><span class="co">#&gt; [1] "Done 1 / 2 total runs"</span></span>
<span><span class="co">#&gt; -- Processing Assets and Scenarios. </span></span>
<span><span class="co">#&gt; -- Transforming to Trisk model input. </span></span>
<span><span class="co">#&gt; -- Calculating baseline, target, and shock trajectories. </span></span>
<span><span class="co">#&gt; -- Calculating net profits. </span></span>
<span><span class="co">#&gt; -- Calculating market risk. </span></span>
<span><span class="co">#&gt; -- Calculating credit risk. </span></span>
<span><span class="co">#&gt; Removed 15 rows when checking for compatibility with merton model. </span></span>
<span><span class="co">#&gt; [1] "Done 2 / 2 total runs"</span></span>
<span><span class="co">#&gt; [1] "All runs completed."</span></span>
<span></span>
<span><span class="co"># Print sensitivity analysis results for the filtered subset</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sensitivity_analysis_results_on_filtered_assets</span><span class="op">[</span><span class="st">"npv"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $npv</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 30 Ã— 9</span></span></span>
<span><span class="co">#&gt;    run_id          company_id asset_id company_name asset_name sector technology</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1101c4da-d7e8-â€¦ E10000000â€¦ P100000â€¦ ArcelorMittâ€¦ ArcelorMiâ€¦ Steel  EAF-DRI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1101c4da-d7e8-â€¦ E10000000â€¦ P100000â€¦ United Statâ€¦ U.S. Steeâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1101c4da-d7e8-â€¦ E10000000â€¦ P100000â€¦ United Statâ€¦ U.S. Steeâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1101c4da-d7e8-â€¦ E10000000â€¦ P100000â€¦ Siderca SAIâ€¦ TenarisSiâ€¦ Steel  EAF-DRI   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1101c4da-d7e8-â€¦ E10000013â€¦ P100000â€¦ Ternium Argâ€¦ Ternium Sâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1101c4da-d7e8-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1101c4da-d7e8-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1101c4da-d7e8-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1101c4da-d7e8-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1101c4da-d7e8-â€¦ E10000100â€¦ P100000â€¦ Cleveland-Câ€¦ Clevelandâ€¦ Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 20 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 2 more variables: net_present_value_baseline &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   net_present_value_shock &lt;dbl&gt;</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sensitivity_analysis_results_on_filtered_assets</span><span class="op">[</span><span class="st">"pd"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $pd</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 65 Ã— 7</span></span></span>
<span><span class="co">#&gt;    run_id              company_id company_name sector  term pd_baseline pd_shock</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>               <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1101c4da-d7e8-4d7dâ€¦ E10000000â€¦ United Statâ€¦ Steel      1    1.41<span style="color: #949494;">e</span><span style="color: #BB0000;">-11</span>  0.110  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1101c4da-d7e8-4d7dâ€¦ E10000000â€¦ United Statâ€¦ Steel      2    1.87<span style="color: #949494;">e</span><span style="color: #BB0000;">- 6</span>  0.216  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1101c4da-d7e8-4d7dâ€¦ E10000000â€¦ United Statâ€¦ Steel      3    1.03<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.282  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1101c4da-d7e8-4d7dâ€¦ E10000000â€¦ United Statâ€¦ Steel      4    7.97<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.329  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1101c4da-d7e8-4d7dâ€¦ E10000000â€¦ United Statâ€¦ Steel      5    2.78<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>  0.365  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1101c4da-d7e8-4d7dâ€¦ E10000000â€¦ Siderca SAIâ€¦ Steel      1    3.57<span style="color: #949494;">e</span><span style="color: #BB0000;">-12</span>  0.001<span style="text-decoration: underline;">73</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1101c4da-d7e8-4d7dâ€¦ E10000000â€¦ Siderca SAIâ€¦ Steel      2    9.12<span style="color: #949494;">e</span><span style="color: #BB0000;">- 7</span>  0.023<span style="text-decoration: underline;">1</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1101c4da-d7e8-4d7dâ€¦ E10000000â€¦ Siderca SAIâ€¦ Steel      3    6.27<span style="color: #949494;">e</span><span style="color: #BB0000;">- 5</span>  0.058<span style="text-decoration: underline;">7</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1101c4da-d7e8-4d7dâ€¦ E10000000â€¦ Siderca SAIâ€¦ Steel      4    5.41<span style="color: #949494;">e</span><span style="color: #BB0000;">- 4</span>  0.096<span style="text-decoration: underline;">2</span> </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1101c4da-d7e8-4d7dâ€¦ E10000000â€¦ Siderca SAIâ€¦ Steel      5    2.01<span style="color: #949494;">e</span><span style="color: #BB0000;">- 3</span>  0.132  </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 55 more rows</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sensitivity_analysis_results_on_filtered_assets</span><span class="op">[</span><span class="st">"trajectories"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $trajectories</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1,600 Ã— 22</span></span></span>
<span><span class="co">#&gt;    run_id    asset_id asset_name company_id company_name  year sector technology</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1101c4daâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>020 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 1101c4daâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>021 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 1101c4daâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>022 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 1101c4daâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>023 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 1101c4daâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>024 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 1101c4daâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>025 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 1101c4daâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>026 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 1101c4daâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>027 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 1101c4daâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>028 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 1101c4daâ€¦ GASTUSAâ€¦ <span style="color: #BB0000;">NA</span>         d6ca6f482â€¦ <span style="color: #BB0000;">NA</span>            <span style="text-decoration: underline;">2</span>029 Steel  BOF-BF    </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 1,590 more rows</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 14 more variables: production_plan_company_technology &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   production_baseline_scenario &lt;dbl&gt;, production_target_scenario &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   production_shock_scenario &lt;dbl&gt;, pd &lt;dbl&gt;, net_profit_margin &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   debt_equity_ratio &lt;dbl&gt;, volatility &lt;dbl&gt;, scenario_price_baseline &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   price_shock_scenario &lt;dbl&gt;, net_profits_baseline_scenario &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   net_profits_shock_scenario &lt;dbl&gt;, â€¦</span></span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">sensitivity_analysis_results_on_filtered_assets</span><span class="op">[</span><span class="st">"params"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $params</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 Ã— 11</span></span></span>
<span><span class="co">#&gt;   baseline_scenario target_scenario scenario_geography carbon_price_model</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>           <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>             </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> Steel_baseline    Steel_NZ        Global             no_carbon_tax     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> Steel_baseline    Steel_NZ        Global             no_carbon_tax     </span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># â„¹ 7 more variables: risk_free_rate &lt;dbl&gt;, discount_rate &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   growth_rate &lt;dbl&gt;, div_netprofit_prop_coef &lt;dbl&gt;, shock_year &lt;dbl&gt;,</span></span></span>
<span><span class="co">#&gt; <span style="color: #949494;">#   market_passthrough &lt;dbl&gt;, run_id &lt;chr&gt;</span></span></span></code></pre></div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
